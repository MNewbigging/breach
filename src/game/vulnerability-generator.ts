import { CorePasswordMetadata } from "./core-password-generator";

// UI, state saving and layer awards only need this info for v's
export interface SlimVulnerability {
  type: string;
  hint: string;
}

// Hydrate SlimV into V class which implements this
export interface Vulnerability {
  hint: string;
  test: (password: string) => boolean;
}

// E.g
export class ExactLengthV implements Vulnerability {
  constructor(
    public hint: string,
    private exactLength: number,
  ) {}

  test = (password: string) => password.length === this.exactLength;
}

export function getSlimVulnerabilities(passwordMeta: CorePasswordMetadata) {
  // Use metadata to generate vulnerability hint pool
  const hints: SlimVulnerability[] = [];

  // Exact length - consider if this info should always be known and not a hint
  hints.push({
    type: "exact-length",
    hint: `Length is ${passwordMeta.length}`,
  });

  // Sum
  hints.push({
    type: "sum",
    hint: `Sum is ${passwordMeta.sum}`,
  });

  // Vowel count
  hints.push({
    type: "vowel-exact",
    hint: `Exactly ${passwordMeta.vowelCount} vowels`,
  });

  // Dupes
  hints.push({
    type: "duplicate-characters",
    hint: `${passwordMeta.hasDuplicateChars ? "Has" : "No"} duplicate characters`,
  });

  return hints;
}
